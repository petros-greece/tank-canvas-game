<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tank Rotated 90 Degrees Right</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #e0e0e0;
    }
    canvas {
      background-color: #ffffff;
    }
  </style>
</head>
<body>
  <canvas id="tankCanvas" width="700" height="700"></canvas>

  <script>
    // Λήψη του canvas και του context
    const canvas = document.getElementById("tankCanvas");
    const ctx = canvas.getContext("2d");

    game = {
      //frame: 0
    }

    /////////////////////////////////////////////////////////

    function Tank(ctx, options){
        this.ctx = ctx;
        this.position = this.position || {}
        this.position.x = options.position.x || 200,
        this.position.y = options.position.y || 130,
        this.bodyFillStyle = "#4c8c4a",
        this.towerFillStyle = "#3e6d3b",
        this.canonFilleStyle = "#2b4b29",
        this.wheelsFillStyle = "red",
        this.wheelTracksFillStyle = "yellow",
        this.wheelLineNum = 10,
        this.size = 10, 
        this.speed = 1,
        this.frame = 0,
        this.comp = {

        }
        this.angle = 90;
    }

    Tank.prototype.init = function(){
      this.comp.fullSize = 14*this.size;
      this.comp.halfSize = 7*this.size;
      this.comp.lineDist = (this.comp.fullSize) / this.wheelLineNum;
      this.frame = Math.floor(Math.random()*this.comp.lineDist);
    } 

    Tank.prototype.render = function() {
   
      const size = this.size;
      const pos = this.position;
      const ctx = this.ctx;

      // Σχεδίαση του σώματος του τανκ
      ctx.fillStyle = this.bodyFillStyle;
      ctx.fillRect(pos.x - this.comp.halfSize, pos.y - 3.5 * size, this.comp.fullSize, this.comp.halfSize); // Οριζόντιο ορθογώνιο για το σώμα του τανκ

      // Σχεδίαση του πύργου
      ctx.fillStyle = this.towerFillStyle;
      ctx.beginPath();
      ctx.arc(pos.x, pos.y, 2 * size, 0, Math.PI * 2);
      ctx.fill();


      // Σχεδίαση του κανονιού
      ctx.fillStyle = this.canonFilleStyle;
      ctx.fillRect(pos.x + size * 2, pos.y - size * 0.5, 6 * size, size);

      // Σχεδίαση των ερπυστριών
      ctx.fillStyle = this.wheelTracksFillStyle;
      ctx.fillRect(pos.x - this.comp.halfSize, pos.y - 5.5 * size, this.comp.fullSize, 2 * size); // Άνω ερπύστρια
      ctx.fillRect(pos.x - this.comp.halfSize, pos.y + 3.5 * size, this.comp.fullSize, 2 * size); // Κάτω ερπύστρια

      // Σχεδίαση τροχών στις ερπυστριές
      ctx.fillStyle = this.wheelsFillStyle;

      const lineDist = (this.comp.fullSize) / this.wheelLineNum;
      const frame = this.frame % lineDist;

      for (let i = 0; i < this.wheelLineNum; i++) {
        ctx.beginPath();
        ctx.moveTo(pos.x - this.comp.halfSize + (i * lineDist + frame), pos.y - 3.5 * size, 0.8 * size);
        ctx.lineTo(pos.x - this.comp.halfSize + (i * lineDist + frame), pos.y - 5.5 * size, 0.8 * size)
        ctx.stroke()

        // Τροχοί κάτω ερπυστριας
        ctx.beginPath();
        ctx.moveTo(pos.x - this.comp.halfSize + (i * lineDist + frame), pos.y + 3.5 * size, 0.8 * size);
        ctx.lineTo(pos.x - this.comp.halfSize + (i * lineDist + frame), pos.y + 5.5 * size, 0.8 * size)
        ctx.stroke()
        
  
      }
       
      ctx.restore(); // Restore the context to remove clipping region
      this.frame+=1;
    }

    Tank.prototype.move = function(){
      //this.save();
      ctx.save();

// Move the rotation point to the rectangle's center
ctx.translate(x, y);

// Rotate the canvas
ctx.rotate(angle);

      this.position.y+= Math.cos(this.angle);
      this.position.x+= Math.sin(this.angle);
      this.restore();
    }




    /////////////////////////////////////////////////////////////
    options = {
        position: {x: 200, y: 70},
        bodyFillStyle: "#4c8c4a",
        towerFillStyle: "#3e6d3b",
        canonFilleStyle: "#2b4b29",
        wheelsFillStyle: "red",
        wheelTracksFillStyle: "yellow",
        wheelLineNum: 5,
        size: 5, 
        speed: 1,
        frame: 0
    }

    let tanks = [];

    for(let i=0;  i<5; i+=1){
     
      //debugger;
      let tank =  new Tank(ctx, options);
      options.position.y+= 130;
      tank.init();
      tanks.push(tank);
    }

    setInterval(function() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // for(let i=0;  i<5; i+=1){
      //   tanks[i].render();
      // }

      tanks.forEach((t)=>{
        t.move();
        t.render()
       //console.log(tanks)
      });
      //renderTank(ctx, options);
      // tank.render();
      // options.position.x += options.speed;
      // options.frame+=1;
    }, 20);


  </script>
</body>
</html>
